{% load static %}

<script class="datetime-flatpickr-script">
  // Инициализация flatpickr для форм
flatpickr('.flatpickr', {
    enableTime: true, 
    dateFormat: "d.m.Y H:i",
    time_24hr: true,
    locale: "ru",
    minDate: new Date(),
});
</script>


<div class="modal fade" id="addTaskForRequestModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="addTaskForRequestModalModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addTaskForRequestModalLabel">Новая задача для заявки</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <form id="addNewTaskForRequest" action="{% url 'crm:add_task_for_request' %}" method="post">
                {% csrf_token %}
                <input type="hidden" name="manager_id" value="{{manager_id}}" required>
                <input type="hidden" name="service_request_id" value="{{service_request_id}}" required>
                <input minlength="5" maxlength="50" name="title" type="text" class="form-control mb-2" placeholder="название задачи" required>
                <textarea minlength="5" rows="5" class="form-control" name="text" id="" placeholder="описание задачи" required></textarea>
                <hr class="hr mb-2">
                <div required class="datetime-for-task-container d-flex flex-column align-items-start justify-content-end">
                <!-- <label for="must_be_completed_by"><h5>Срок выполнения</h5></label> -->
                <div class="d-flex">
                  <h6 class="me-2">Срок выполнения задачи</h6>
                  <div style="cursor:help" 
                  data-bs-toggle="tooltip" 
                  data-bs-placement="top" 
                  title="Дата и время выполнения задачи.">
                    <i class="bi bi-info-circle"></i>
                </div>
              </div> 
                <input required type="datetime-local" name="must_be_completed_by" id="must_be_completed_by" class="flatpickr w-50 form-control" placeholder="выбрать дату">
                </div>
                <hr class="hr mb-2">
                <div class="d-flex">
                    <h6 class="me-2">Оповещение о сроке выполнения</h6>
                    <div style="cursor:help" 
                    data-bs-toggle="tooltip" 
                    data-bs-placement="top" 
                    title="Получать оповещение о сроках выполнения задачи (за день, за час, и в момент окончания срока исполнения).">
                      <i class="bi bi-info-circle"></i>
                    </div>
                </div>
                <label class="switch-1 d-flex align-items-center justify-content-start">
                    <!-- <h5>Включить напоминание</h5> -->
                    <div class="">Выключить</div> 
                    <input name="notifications" type="checkbox" />
                    <span class="check-slider-1 mx-2"></span>
                    <div class="">Включить</div> 
                </label>
                <hr class="hr mb-2">
                <!-- Добавление напоминания -->
                <div class="add_reminder_placeholder">
                  <div class="add_reminder_title d-flex">
                    <h6 class="me-2">Напоминание</h6>
                    <div class="" style="cursor:help" 
                    data-bs-toggle="tooltip" 
                    data-bs-placement="top" 
                    title="Напоминания для задачи.">
                    <i class="bi bi-info-circle"></i>
                  </div>
                  </div>
                  <div class="add_reminder_body">
                    <button class="verg-button-1 border-0" type="button" data-bs-toggle="collapse" data-bs-target="#collapseReminders" aria-expanded="false" aria-controls="collapseExample">
                      Настроить напоминание <i class="bi bi-bell"></i>
                    </button>
                  </div>
                  <div class="collapse mt-2" id="collapseReminders">
                    <div class="card card-body">

                      <!-- Select reminder mode -->
                      <h6>Укажите тип напоминания о задаче</h6>
                      <div class="verg-green-checkbox-container">
                        <input class="verg-green-checkbox-input" name="reminderMode-daily" id="dailyReminderModeCheckInput" type="checkbox" />
                        <label class="verg-green-checkbox-label" for="dailyReminderModeCheckInput">
                          <span class="verg-green-checkbox-text me-2">Напоминать раз в день</span>
                          <div style="cursor:help" 
                            data-bs-toggle="tooltip" 
                            data-bs-placement="top" 
                            title="Получать напоминания о задаче каждый день.">
                              <i class="bi bi-info-circle"></i>
                          </div>
                        </label>
                      </div>

                      <div class="verg-green-checkbox-container">
                        <input class="verg-green-checkbox-input" name="reminderMode-weekly" id="weelklyReminderModeCheckInput" type="checkbox" />
                        <label class="verg-green-checkbox-label" for="weelklyReminderModeCheckInput">
                          <span class="verg-green-checkbox-text me-2">Напоминать раз в неделю</span>
                          <div style="cursor:help" 
                            data-bs-toggle="tooltip" 
                            data-bs-placement="top" 
                            title="Получать напоминания о задаче раз в неделю.">
                              <i class="bi bi-info-circle"></i>
                          </div>
                        </label>
                      </div>

                      <div class="verg-green-checkbox-container">
                        <input class="verg-green-checkbox-input" name="reminderMode-monthly" id="monthlyReminderModeCheckInput" type="checkbox" />
                        <label class="verg-green-checkbox-label" for="monthlyReminderModeCheckInput">
                          <span class="verg-green-checkbox-text me-2">Напоминать раз в месяц</span>
                          <div style="cursor:help" 
                            data-bs-toggle="tooltip" 
                            data-bs-placement="top" 
                            title="Получать напоминания о задаче раз в месяц.">
                              <i class="bi bi-info-circle"></i>
                          </div>
                        </label>
                      </div>

                      <div class="verg-green-checkbox-container">
                        <input class="verg-green-checkbox-input" name="reminderMode-custom" id="customReminderModeCheckInput" type="checkbox" />
                        <label class="verg-green-checkbox-label" for="customReminderModeCheckInput">
                          <span class="verg-green-checkbox-text me-2">Персональные настройки</span>
                          <div style="cursor:help" 
                            data-bs-toggle="tooltip" 
                            data-bs-placement="top" 
                            title="Персональные настройки напоминания.">
                              <i class="bi bi-info-circle"></i>
                          </div>
                        </label>
                      </div>
                      <!-- Select reminder mode end-->

                      <!-- Select days and time for custom reminder -->
                      <div class="custom-reminder-params d-none">
                        <h6>Тут персональные настройки. Выбор дней и времени</h6>
                        <div class="days-btn-container">
                          <input name="monday" class="day-btn" id="monday" type="checkbox" checked="false" />
                          <label class="day-label" for="monday">Пон.</label>
                        
                          <input name="tuesday" class="day-btn" id="tuesday" type="checkbox" checked="false" />
                          <label class="day-label" for="tuesday">Вт.</label>
                        
                          <input name="wednesday" class="day-btn" id="wednesday" type="checkbox" checked="false" />
                          <label class="day-label" for="wednesday">Ср.</label>
                        
                          <input name="thursday" class="day-btn" id="thursday" type="checkbox" checked="false" />
                          <label class="day-label" for="thursday">Чт.</label>
                        
                          <input name="friday" class="day-btn" id="friday" type="checkbox" checked="false" />
                          <label class="day-label" for="friday">Пт.</label>
                        
                          <input name="saturday" class="day-btn" id="saturday" type="checkbox" checked="false" />
                          <label class="day-label" for="saturday">Сб.</label>

                          <input name="sunday" class="day-btn" id="sunday" type="checkbox" checked="false" />
                          <label class="day-label" for="sunday">Вск.</label>
                        </div>
                      </div>  
                         
                      <!-- Select days and time for custom reminder end-->

                    </div>
                  </div>
                </div>
                <!-- Добавление напоминания end-->

                <div style="color: red; font-weight: 600;" class="new-task-error-place mt-2"></div>
                <hr class="hr">
                <button type="submit" class="verg-button-green">Сохранить</button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Отменить</button>
            </form>

        </div>
      </div>
    </div>
    <script src="{% static 'crm/js/add-task-for-request-detail.js' %}"></script>
</div>
